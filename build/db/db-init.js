// Generated by IcedCoffeeScript 1.6.3-g
(function() {
  var dbConfig, dbInitServices;



  exports.dbDefineExpress = function(services) {
    return function(db, models, next) {
      dbConfig(db);
      models.book = db.define("books", {
        words_count: Number
      });
      dbInitServices(db, services);
      return next();
    };
  };

  dbConfig = function(db) {
    return db.settings.set("properties.primary_key", "id");
  };

  dbInitServices = function(db, services) {
    return services.books = {
      getHMap: function(bookId, userId, cb) {
        var data, query;
        query = "SELECT * FROM getBookHeatMap(?,?)";
        data = [bookId, userId];
        return db.driver.execQuery(query, data, cb);
      },
      getReadTimes: function(bookId, userId, cb) {
        var data, query;
        query = "SELECT * FROM getBookReadTimes(?,?)";
        data = [bookId, userId];
        return db.driver.execQuery(query, data, cb);
      },
      getStickiness: function(bookId, dateFinishedReading, cb) {
        var data, query;
        query = "SELECT * FROM getBookStickiness(?,?)";
        data = [bookId, dateFinishedReading];
        return db.driver.execQuery(query, data, cb);
      }
    };
  };

}).call(this);
